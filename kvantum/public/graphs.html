<!DOCTYPE HTML>
<html>
<head>
    <title>Metrics Visualizer</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

    {#macro chart name width height}
    <canvas id="{{name}}" width="{{width}}" height="{{height}}"></canvas>
    {/macro}
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-sm col-md col-lg">
            <div style="text-align: center;">
                <h1>Data based on <span id="num_items"></span> requests (in milliseconds)</h1>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm col-md col-lg">
            <h3>Loading time: Max values</h3>
            #chart ("max" "100" "100")#
        </div>
        <div class="col-sm col-md col-lg">
            <h3>Loading time: Min values</h3>
            #chart ("min" "100" "100")#
        </div>
        <div class="col-sm col-md col-lg">
            <h3>Loading time: mean values</h3>
            #chart ("mean" "100" "100")#
        </div>
    </div>
    <div class="row">
        <div class="col-sm col-md col-lg">
            <h3>Worker prepare: Mean values</h3>
            #chart ("prepare" "" "")#
        </div>
    </div>
</div>


<footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    /* Chart library */
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js"></script>
    <script>
        var data =
            {"timers":{"sessionPreparation":{"min":0.0,"max":0.0,"mean":0.0,"name":"sessionPreparation","count":0},"requestHandling":{"min":78.246032,"max":757.62762,"mean":314.01652934369645,"name":"requestHandling","count":181},"workerPrepare":{"min":76.41309799999999,"max":736.556192,"mean":305.45600186113313,"name":"workerPrepare","count":181},"workerContextHandling":{"min":1.582503,"max":53.6607,"mean":6.933538256085556,"name":"workerContextHandling","count":181},"requestPreparation":{"min":0.22844399999999998,"max":13.556317,"mean":0.6641771270960476,"name":"requestPreparation","count":181},"contentHandling":{"min":0.6828919999999999,"max":30.646696,"mean":2.52614464078801,"name":"contentHandling","count":181},"compression":{"min":0.133268,"max":6.1449169999999995,"mean":0.2525660939233781,"name":"compression","count":181},"readInput":{"min":75.863646,"max":735.795345,"mean":304.1813584155609,"name":"readInput","count":181}}};

        var maxValues = [
            data.timers.workerPrepare.max,
            data.timers.sessionPreparation.max,
            data.timers.compression.max,
            data.timers.contentHandling.max
        ];
        var minValues = [
            data.timers.workerPrepare.min,
            data.timers.sessionPreparation.min,
            data.timers.compression.min,
            data.timers.contentHandling.min
        ];
        var meanValues = [
            data.timers.workerPrepare.mean,
            data.timers.sessionPreparation.mean,
            data.timers.compression.mean,
            data.timers.contentHandling.mean
        ];
        var prepareValues = [
            data.timers.readInput.mean,
            data.timers.requestPreparation.mean
        ];
        var labels = [
            "Prepare Workers",
            "Handle Sessions",
            "Compression",
            "Handle Content"
        ];
        var prepareLabels = [
            "Read Input",
            "Prepare Request"
        ];

        $("#num_items").text(data.timers.requestHandling.count);

        var ctxmax = document.getElementById("max").getContext("2d");
        var max = new Chart(ctxmax, {
            type: 'pie',
            data: {
                datasets: [{
                    labels: 'Max values',
                    data: maxValues,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                }],
                labels: labels
            }
        });
        var ctxmin = document.getElementById("min").getContext("2d");
        var min = new Chart(ctxmin, {
            type: 'pie',
            data: {
                datasets: [{
                    labels: 'Min values',
                    data: minValues,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                }],
                labels: labels
            }
        });
        var ctxmean = document.getElementById("mean").getContext("2d");
        var mean = new Chart(ctxmean, {
            type: 'pie',
            data: {
                datasets: [{
                    labels: 'Mean values',
                    data: meanValues,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                }],
                labels: labels
            }
        });
        var ctxprepare = document.getElementById("prepare").getContext("2d");
        var prepare = new Chart(ctxprepare, {
            type: 'pie',
            data: {
                datasets: [{
                    labels: 'Prepare values',
                    data: prepareValues,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                }],
                labels: prepareLabels
            }
        });
    </script>
</footer>
</body>
</html>
